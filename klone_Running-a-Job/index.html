
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../klone_Installing-Programs/">
      
      
        <link rel="next" href="../klone_RStudio-Server/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Running a job - Roberts Lab Handbook</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-header" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Roberts Lab Handbook" class="md-header__button md-logo" aria-label="Roberts Lab Handbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Roberts Lab Handbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Running a job
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/RobertsLab/resources/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Roberts Lab Handbook" class="md-nav__button md-logo" aria-label="Roberts Lab Handbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Roberts Lab Handbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/RobertsLab/resources/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lab Culture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Lab Culture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Onboarding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Onboarding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Code-of-Conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Environment-and-Expectations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment and Expectations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lab-Communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab Communication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lab-Notebooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab Notebooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEI-Resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DEI Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../External-Communication-and-Funding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    External Communication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lab-Safety/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab Safety
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Undergraduate-contract/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Undergraduate Contract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../How-to-Grad-School-Slides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Grad School (Outreach Slides)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Computing and Code
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Computing and Code
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Computing-Best-Practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Agentic-Coding-Tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agentic Coding Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_Snippets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Snippets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Computing-Hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Computing Hardware
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lab-Software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab Software
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" checked>
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Klone Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Klone Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Containers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_Conda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conda
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_Adding-a-User/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    New User
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_Logging-In/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging in
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_Node-Types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Node Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_Data-Storage-and-System-Organization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Storage and System Organization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_File-Transfers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Transfers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_Installing-Programs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing Programs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Running a job
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Running a job
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-header" class="md-nav__link">
    <span class="md-ellipsis">
      The Header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-execute-portion" class="md-nav__link">
    <span class="md-ellipsis">
      The Execute portion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slurm-script-templateexample-multiple-commands" class="md-nav__link">
    <span class="md-ellipsis">
      SLURM Script Template/Example - Multiple Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SLURM Script Template/Example - Multiple Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-script-example" class="md-nav__link">
    <span class="md-ellipsis">
      Command script example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slurm-script-templateexample-single-command" class="md-nav__link">
    <span class="md-ellipsis">
      SLURM Script Template/Example - Single Command
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_RStudio-Server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RStudio Server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../klone_VS-Code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VS Code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Raven Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Raven Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raven_Conda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conda
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raven_RStudio-Server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RStudio Server
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Databases and Catalogs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Databases and Catalogs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lab-Inventory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Pubathon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pubathon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Digital-Media/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Digital Media
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Experiment-Database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experiment Database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Genomic-Resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genomic Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../music/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spotify Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Protocols
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Protocols
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Purchasing-and-Reimbursement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Purchasing and Reimbursement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Data-Management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data-Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lab Protocols
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Lab Protocols
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protocols/protocol-bullet_blender/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bullet Blender
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protocols/protocol-qPCR/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    qPCR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protocols/resazurin-assay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resazurin Assay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protocols/protocol-reverse_transcription/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reverse Transcription
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chemical-Standard-Operating-Protocols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chemical SOPs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Alarm-Information/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Alarm Information
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bioinformatic Workflows
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Bioinformatic Workflows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bio_Basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bio-Annotation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Annotation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bio_DNA-methylation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DNA Methylation Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bio-Gene-expression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gene Expression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bio_Transcriptome-assembly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transcriptome Assembly
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-header" class="md-nav__link">
    <span class="md-ellipsis">
      The Header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-execute-portion" class="md-nav__link">
    <span class="md-ellipsis">
      The Execute portion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slurm-script-templateexample-multiple-commands" class="md-nav__link">
    <span class="md-ellipsis">
      SLURM Script Template/Example - Multiple Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SLURM Script Template/Example - Multiple Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-script-example" class="md-nav__link">
    <span class="md-ellipsis">
      Command script example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slurm-script-templateexample-single-command" class="md-nav__link">
    <span class="md-ellipsis">
      SLURM Script Template/Example - Single Command
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/RobertsLab/resources/blob/master/docs/klone_Running-a-Job.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


  <h1>Running a job</h1>

<p><strong>NOTE</strong> - Use <a href="https://robertslab.github.io/resources/klone_Data-Storage-and-System-Organization/#3-temporary-storage"><code>/gscratch/scrubbed/&lt;UW_NetID&gt;</code></a> for running jobs (i.e. writing output files to). As the name suggests, you will need to move files to a "bird" for archival storage. If you are needing a set of large raw files for analysis - also place these in the <code>/gscratch/scrubbed/&lt;UW_NetID&gt;</code> directory.</p>
<hr />
<p><code>sbatch</code> is the main execution command for the job scheduler (<a href="https://slurm.schedmd.com/overview.html">SLURM</a>). It spools up a compute node for long-term or compute-intensive tasks such as assemblies, blasts, alignments, etc.</p>
<p><code>sbatch</code> can be run from a login node with the command:</p>
<div class="highlight"><pre><span></span><code>sbatch<span class="w"> </span>&lt;slurm_script_name.sh&gt;
</code></pre></div>
<p><code>sbatch</code> requires a shell script to function, with two main parts: the header and the execute portion.</p>
<h2 id="the-header">The Header</h2>
<pre>
<code>
#!/bin/bash
## Job Name
#SBATCH --job-name=<b>myjob</b>
## Allocation Definition
#SBATCH --account=srlab
#SBATCH --partition=cpu-g2-mem2x
## Nodes
#SBATCH --nodes=1
## Walltime (days-hours:minutes:seconds format)
#SBATCH --time=<b>dd-hh:mm:ss</b>
## Memory per node
#SBATCH --mem=<b>450G</b>
##turn on e-mail notification
#SBATCH --mail-type=ALL
#SBATCH --mail-user=$USER@uw.edu
## Specify the working directory for this job
#SBATCH --chdir=<b>/gscratch/srubbed/<UW_NetID>/to/your/desired/directory</b>
</code>
</pre>

<p><b>Bolded sections above must be changed prior to execution.</b> Those specific sections are described in more detail.</p>
<ul>
<li>
<p><code>--job-name=</code><strong><code>myjob</code></strong> is an identifier for your current job. It's what shows up in <code>scontrol</code> and <code>squeue</code> calls. Providing a unique-to-you job name may be helpful for distinguishing between different runs, by is not necessary.</p>
</li>
<li>
<p><code>--time=</code><strong><code>dd-hh:mm:ss</code></strong> is the "wall" time, or how long we are reserving the node for our use. This argument requires some consideration and knowledge about the program you're running prior to execution. Selecting too little wall time will cause the scheduler to kill your process mid-run when time runs out. Selecting too much time limits other's ability to use Hyak functions, but the scheduler releases a node upon program completion usually, so this is a secondary consideration.</p>
</li>
<li>
<p><code>--mem=</code><strong><code>450G</code></strong> specifies how much memory (RAM) to allocate to the process. We have a single slice with a maximum of 490GB of RAM. Specifying a value below the maximum allows for some additional processing overhead. Usually, setting this to the maximum is fine, but reserving only what you might need can allow for multiple users to use the slice at the same time.</p>
</li>
<li>
<p><code>--chdir=</code><strong><code>/gscratch/srubbed/&lt;UW_NetID&gt;/to/your/desired/directory</code></strong> indicates the working directory where output will be written. All jobs should be executed in your <code>/gscratch/srubbed/&lt;UW_NetID&gt;</code> directory. See the <a href="https://github.com/RobertsLab/hyak_mox/wiki/Data-Storage-&amp;-System-Organization">Data Storage &amp; System Organization section of the wiki</a> for more info.</p>
</li>
</ul>
<h2 id="the-execute-portion">The Execute portion</h2>
<p>This section contains the commands/programs you want executed. You can treat it like the command line, in that it executes commands sequentially as input. These can include program calls, module loading, making directories, etc. However, since Klone relies on the use of <a href="../klone_containers/">containers</a> to run, your SLURM script will <em>require</em> the following:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="c1"># Load modules</span>
<span class="w">  </span>module<span class="w"> </span>load<span class="w"> </span>apptainer

<span class="w">  </span><span class="c1"># Execute Roberts Lab bioinformatics container</span>
<span class="w">  </span><span class="c1"># Binds home directory</span>
<span class="w">  </span><span class="c1"># Binds /gscratch directory</span>
<span class="w">  </span><span class="c1"># Directory bindings allow outputs to be written to the hard drive.</span>
<span class="w">  </span>apptainer<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--home<span class="w"> </span><span class="nv">$PWD</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--bind<span class="w"> </span>/mmfs1/home/<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--bind<span class="w"> </span>/mmfs1/gscratch/<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--bind<span class="w"> </span>/gscratch/<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>/gscratch/srlab/containers/srlab-bioinformatics-container-&lt;git_commit_hash&gt;.sif<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>&lt;commands_script.sh&gt;
</code></pre></div>
<h2 id="slurm-script-templateexample-multiple-commands">SLURM Script Template/Example - Multiple Commands</h2>
<p>If you need to execute multiple commands using a container, which will usually be the case and is shown in the example directly above this, you'll need to place those commands in a separate script.</p>
<h3 id="command-script-example">Command script example</h3>
<p>Here's an example script, called <code>commands.sh</code>. This is where we'll set all of our variables and execute various commands/programs we'd like for our analysis:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="c1">#!/bin/bash</span>

<span class="w">  </span><span class="c1"># Requires Bash &gt;=4.0, as script uses associative arrays.</span>

<span class="w">  </span><span class="c1">###################################################################################</span>
<span class="w">  </span><span class="c1"># These variables need to be set by user</span>

<span class="w">  </span><span class="c1">## Number of CPU threads to use for programs (if applicable)</span>
<span class="w">  </span><span class="nv">threads</span><span class="o">=</span><span class="m">28</span>

<span class="w">  </span><span class="c1">## Programs associative array</span>
<span class="w">  </span><span class="c1">## Using array is useful for logging program options (see end of script)</span>
<span class="w">  </span><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>programs_array

<span class="w">  </span><span class="nv">programs_array</span><span class="o">=(</span>
<span class="w">  </span><span class="o">[</span>bowtie2<span class="o">]=</span><span class="s2">&quot;bowtie2&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="o">[</span>bowtie2_build<span class="o">]=</span><span class="s2">&quot;bowtie2-build&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="o">[</span>samtools_index<span class="o">]=</span><span class="s2">&quot;samtools index&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="o">[</span>samtools_sort<span class="o">]=</span><span class="s2">&quot;samtools sort&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="o">[</span>samtools_view<span class="o">]=</span><span class="s2">&quot;samtools view&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="o">[</span>samtools_faidx<span class="o">]=</span><span class="s2">&quot;samtools faidx&quot;</span>
<span class="w">  </span><span class="o">)</span>


<span class="w">  </span><span class="c1">## INPUT FILES ##</span>
<span class="w">  </span><span class="nv">genome_fasta</span><span class="o">=</span><span class="s2">&quot;./data/C_gigas/genomes/cgig-NCBI-genome.fasta&quot;</span>
<span class="w">  </span><span class="nv">genome_name</span><span class="o">=</span><span class="s2">&quot;cgig-NCBI-genome&quot;</span>

<span class="w">  </span><span class="c1">###################################################################################</span>


<span class="w">  </span><span class="c1"># Create FastA index</span>
<span class="w">  </span><span class="si">${</span><span class="nv">programs_array</span><span class="p">[trinsamtools_faidxity]</span><span class="si">}</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">genome_fasta</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="w">  </span><span class="c1">###################################################################################</span>

<span class="w">  </span><span class="c1"># Capture program options</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">programs_array</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Logging program options...&quot;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>program<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!programs_array[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">do</span>
<span class="w">      </span><span class="o">{</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Program options for </span><span class="si">${</span><span class="nv">program</span><span class="si">}</span><span class="s2">: &quot;</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">      </span><span class="c1"># Handle samtools help menus</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">program</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;samtools_index&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">program</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;samtools_sort&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">program</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;samtools_view&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">      </span><span class="k">then</span>
<span class="w">        </span><span class="si">${</span><span class="nv">programs_array</span><span class="p">[</span><span class="nv">$program</span><span class="p">]</span><span class="si">}</span>

<span class="w">      </span><span class="c1"># Handle DIAMOND BLAST menu</span>
<span class="w">      </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">program</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;diamond&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="si">${</span><span class="nv">programs_array</span><span class="p">[</span><span class="nv">$program</span><span class="p">]</span><span class="si">}</span><span class="w"> </span><span class="nb">help</span>

<span class="w">      </span><span class="c1"># Handle NCBI BLASTx menu</span>
<span class="w">      </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">program</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;blastx&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="si">${</span><span class="nv">programs_array</span><span class="p">[</span><span class="nv">$program</span><span class="p">]</span><span class="si">}</span><span class="w"> </span>-help

<span class="w">      </span><span class="c1"># Handle StringTie prepDE script</span>
<span class="w">      </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">program</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;prepDE&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>python3<span class="w"> </span><span class="si">${</span><span class="nv">programs_array</span><span class="p">[</span><span class="nv">$program</span><span class="p">]</span><span class="si">}</span><span class="w"> </span>-h
<span class="w">      </span><span class="k">fi</span>
<span class="w">      </span><span class="si">${</span><span class="nv">programs_array</span><span class="p">[</span><span class="nv">$program</span><span class="p">]</span><span class="si">}</span><span class="w"> </span>-h
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;----------------------------------------------&quot;</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="o">}</span><span class="w"> </span><span class="p">&amp;</span>&gt;&gt;<span class="w"> </span>program_options.log<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">true</span>

<span class="w">      </span><span class="c1"># If MultiQC is in programs_array, copy the config file to this directory.</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">program</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;multiqc&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>cp<span class="w"> </span>--preserve<span class="w"> </span>~/.multiqc_config.yaml<span class="w"> </span>multiqc_config.yaml
<span class="w">      </span><span class="k">fi</span>
<span class="w">    </span><span class="k">done</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Finished logging programs options.&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="k">fi</span>


<span class="w">  </span><span class="c1"># Document programs in PATH (primarily for program version ID)</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Logging system </span><span class="nv">$PATH</span><span class="s2">...&quot;</span>
<span class="w">  </span><span class="o">{</span>
<span class="w">  </span>date
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;System PATH for </span><span class="nv">$SLURM_JOB_ID</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%0.s-&quot;</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..10<span class="o">}</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>:<span class="w"> </span><span class="se">\\</span>n
<span class="w">  </span><span class="o">}</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>system_path.log
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Finished logging system </span><span class="nv">$PATH</span><span class="s2">.&quot;</span>
</code></pre></div>
<p>To run the <code>commands.sh</code> script above in our container on Klone, we would use the following SLURM script, which we'll call <code>example-SLURM-script.sh</code>.</p>
<p>IMPORTANT: <code>&lt;commands.sh&gt;</code> needs to be executable!! Make sure to run <code>chmod +x &lt;commands.sh&gt;</code> to make it executable.</p>
<p>This example will perform the following:</p>
<ul>
<li>Request the slice assigned to our account (<code>--account=srlab</code>)</li>
<li>Request the parition on the <code>srlab</code> slice (<code>--partition=cpu-g2-mem2x</code>)</li>
<li>Set a run time of 10 days (<code>--time=10-00:00:00</code>)</li>
<li>Request 120GB of memory (<code>--mem=120G</code>)</li>
<li>Identify the most recent version of the bioinformatics container to use.</li>
<li>Run the <code>commands.sh</code> script from the bioinformatics container to construct a bowtie2 index of the provided genome FastA.</li>
</ul>
<p>NOTE: This is written to assume that the <code>commands.sh</code> script and the SLURM script are in the same directory.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1">## Job Name</span>
<span class="c1">#SBATCH --job-name=DESCRIPTIVE_JOB_NAME</span>
<span class="c1">## Allocation Definition</span>
<span class="c1">#SBATCH --account=srlab</span>
<span class="c1">#SBATCH --partition=cpu-g2-mem2x</span>
<span class="c1">## Resources</span>
<span class="c1">## Nodes</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">## Walltime (days-hours:minutes:seconds format)</span>
<span class="c1">#SBATCH --time=10-00:00:00</span>
<span class="c1">## Memory per node</span>
<span class="c1">#SBATCH --mem=120G</span>
<span class="c1">##turn on e-mail notification</span>
<span class="c1">#SBATCH --mail-type=ALL</span>
<span class="c1">#SBATCH --mail-user=$USER@uw.edu</span>
<span class="c1">## Specify the working directory for this job</span>
<span class="c1">#SBATCH --chdir=/gscratch/scrubbed/$USER/to/your/desired/directory</span>
<span class="c1">###################################################################################</span>

<span class="c1"># Exit script if any command fails</span>
<span class="nb">set</span><span class="w"> </span>-e

<span class="c1"># Get most recent container git hash</span>
<span class="nv">git_commit_hash</span><span class="o">=</span><span class="k">$(</span>find<span class="w"> </span>/gscratch/srlab/containers/<span class="w"> </span><span class="se">\</span>
-name<span class="w"> </span><span class="s2">&quot;srlab-bioinformatics-container*&quot;</span><span class="w"> </span><span class="se">\</span>
-printf<span class="w"> </span><span class="s2">&quot;%T+ %p\n&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-n<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>awk<span class="w"> </span>-F<span class="o">[</span>-.<span class="o">]</span><span class="w"> </span><span class="s1">&#39;NR == 1 {print $7}&#39;</span><span class="k">)</span>

<span class="c1"># Load modules</span>
module<span class="w"> </span>load<span class="w"> </span>apptainer

<span class="c1"># Execute Roberts Lab bioinformatics container</span>
<span class="c1"># Binds home directory</span>
<span class="c1"># Binds /gscratch directory</span>
<span class="c1"># Directory bindings allow outputs to be written to the hard drive.</span>
apptainer<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="se">\</span>
--home<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
--bind<span class="w"> </span>/mmfs1/home/<span class="w"> </span><span class="se">\</span>
--bind<span class="w"> </span>/mmfs1/gscratch/<span class="w"> </span><span class="se">\</span>
/gscratch/srlab/containers/srlab-bioinformatics-container-<span class="s2">&quot;</span><span class="si">${</span><span class="nv">git_commit_hash</span><span class="si">}</span>$<span class="s2">&quot;</span>.sif<span class="w"> </span><span class="se">\</span>
commands.sh
</code></pre></div>
<p>Finally, to submit the job to SLURM:</p>
<div class="highlight"><pre><span></span><code>sbatch<span class="w"> </span>example-SLURM-script.sh
</code></pre></div>
<p>This will execute <code>example-SLURM-script.sh</code> which contains instructions for submitting it into the SLURM job scheduler and onto our slice (the header portion). The rest of the script will then be executed, which will result in the execution of <code>commands.sh</code>.</p>
<h2 id="slurm-script-templateexample-single-command">SLURM Script Template/Example - Single Command</h2>
<p>Less likely to be used, as many of our analyses require multiple steps, but is still useful to know.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1">## Job Name</span>
<span class="c1">#SBATCH --job-name=DESCRIPTIVE_JOB_NAME</span>
<span class="c1">## Allocation Definition</span>
<span class="c1">#SBATCH --account=srlab</span>
<span class="c1">#SBATCH --partition=cpu-g2-mem2x</span>
<span class="c1">## Resources</span>
<span class="c1">## Nodes</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">## Walltime (days-hours:minutes:seconds format)</span>
<span class="c1">#SBATCH --time=10-00:00:00</span>
<span class="c1">## Memory per node</span>
<span class="c1">#SBATCH --mem=120G</span>
<span class="c1">##turn on e-mail notification</span>
<span class="c1">#SBATCH --mail-type=ALL</span>
<span class="c1">#SBATCH --mail-user=$USER@uw.edu</span>
<span class="c1">## Specify the working directory for this job</span>
<span class="c1">#SBATCH --chdir=/gscratch/scrubbed/$USER/to/your/desired/directory</span>
<span class="c1">###################################################################################</span>

<span class="c1"># Exit script if any command fails</span>
<span class="nb">set</span><span class="w"> </span>-e

<span class="c1"># Get most recent container git hash</span>
<span class="nv">git_commit_hash</span><span class="o">=</span><span class="k">$(</span>find<span class="w"> </span>/gscratch/srlab/containers/<span class="w"> </span><span class="se">\</span>
-name<span class="w"> </span><span class="s2">&quot;srlab-bioinformatics-container*&quot;</span><span class="w"> </span><span class="se">\</span>
-printf<span class="w"> </span><span class="s2">&quot;%T+ %p\n&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-n<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>awk<span class="w"> </span>-F<span class="o">[</span>-.<span class="o">]</span><span class="w"> </span><span class="s1">&#39;NR == 1 {print $7}&#39;</span><span class="k">)</span>

<span class="c1"># Load modules</span>
module<span class="w"> </span>load<span class="w"> </span>apptainer

<span class="c1"># Execute Roberts Lab bioinformatics container</span>
<span class="c1"># Binds home directory</span>
<span class="c1"># Binds /gscratch directory</span>
<span class="c1"># Directory bindings allow outputs to be written to the hard drive.</span>
apptainer<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="se">\</span>
--home<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
--bind<span class="w"> </span>/mmfs1/home/<span class="w"> </span><span class="se">\</span>
--bind<span class="w"> </span>/mmfs1/gscratch/<span class="w"> </span><span class="se">\</span>
/gscratch/srlab/containers/srlab-bioinformatics-container-<span class="s2">&quot;</span><span class="si">${</span><span class="nv">git_commit_hash</span><span class="si">}</span>$<span class="s2">&quot;</span>.sif<span class="w"> </span><span class="se">\</span>
bowtie2_build<span class="w"> </span><span class="se">\</span>
--threads<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="se">\</span>
/gscratch/scrubbed/<span class="s2">&quot;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">&quot;</span>/data/C_gigas/genomes/cgig-ncbi-genome.fasta<span class="w"> </span><span class="se">\</span>
cgig-ncbi-genome
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.action.edit", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>